0
gen_result = [{'key': '', 'value': '10.50.81.60'}, {'key': 'HTTP/S响应码', 'value': '403'}]

init data: [{'key': '', 'value': '10.50.81.60'}, {'key': 'HTTP/S响应码', 'value': '403'}]

valid data: [{"key": "", "value": "10.50.81.60"}, {"key": "HTTP/S响应码", "value": "403"}]

<class 'list'>
[{'key': '', 'value': '10.50.81.60'}, {'key': 'HTTP/S响应码', 'value': '403'}]
Testing ID: 101:
Testing LogText: <178>Nov 15 14:22:33 10.50.81.60 DBAppWAF: 发生时间/2024-11-15 14:22:32,威胁/高,事件/SQL注入,请求方法/POST,URL地址/10.50.81.60:8000/login.php,POST数据/user=admin&password=123456,服务器IP/10.50.81.6,主机名/10.50.81.60:8000,服务器端口/8000,客户端IP/10.20.170.23,客户端端口/45678,客户端环境/Mozilla/5.0 [en] (X11, U; DBAPPSecurity 21.4.3),标签/SQL注入,动作/阻断,HTTP/S响应码/403,攻击特征串/login.php?user=admin&password=123456,触发规则/11010016,访问唯一编号/7425395334018236553,国家/LAN,省/,市/,XFF_IP/
Testing LogField: [{'key': '', 'value': 'Nov 15 14:22:33'}, {'key': '', 'value': '10.50.81.60'}, {'key': '', 'value': 'DBAppWAF'}, {'key': '发生时间', 'value': '2024-11-15 14:22:32'}, {'key': '威胁', 'value': '高'}, {'key': '请求方法', 'value': 'POST'}, {'key': 'URL地址', 'value': '10.50.81.60:8000/login.php'}, {'key': 'POST数据', 'value': 'user=admin&password=123456'}, {'key': '服务器IP', 'value': '10.50.81.6'}, {'key': '客户端环境', 'value': 'Mozilla/5.0 [en] (X11, U; DBAPPSecurity 21.4.3)'}, {'key': '访问唯一编号', 'value': '7425395334018236553'}]
Generated LogField: [{'key': '', 'value': '10.50.81.60'}, {'key': 'HTTP/S响应码', 'value': '403'}]
至少有一个匹配！full_coverage: 9.00%
1
gen_result = [{'key': '', 'value': '10-50-86-12'}, {'key': '威胁', 'value': '中'}, {'key': '请求方法', 'value': 'GET'}, {'key': '主机名', 'value': '10.50.109.90:31001'}, {'key': '客户端端口', 'value': '59135'}, {'key': '客户端IP', 'value': '10.50.24.198'}, {'key': '标签', 'value': 'SQL注入'}, {'key': '动作', 'value': '警告'}, {'key': '国家', 'value': '局域网'}]

init data: [{'key': '', 'value': '10-50-86-12'}, {'key': '威胁', 'value': '中'}, {'key': '请求方法', 'value': 'GET'}, {'key': '主机名', 'value': '10.50.109.90:31001'}, {'key': '客户端端口', 'value': '59135'}, {'key': '客户端IP', 'value': '10.50.24.198'}, {'key': '标签', 'value': 'SQL注入'}, {'key': '动作', 'value': '警告'}, {'key': '国家', 'value': '局域网'}]

valid data: [{"key": "", "value": "10-50-86-12"}, {"key": "威胁", "value": "中"}, {"key": "请求方法", "value": "GET"}, {"key": "主机名", "value": "10.50.109.90:31001"}, {"key": "客户端端口", "value": "59135"}, {"key": "客户端IP", "value": "10.50.24.198"}, {"key": "标签", "value": "SQL注入"}, {"key": "动作", "value": "警告"}, {"key": "国家", "value": "局域网"}]

<class 'list'>
[{'key': '', 'value': '10-50-86-12'}, {'key': '威胁', 'value': '中'}, {'key': '请求方法', 'value': 'GET'}, {'key': '主机名', 'value': '10.50.109.90:31001'}, {'key': '客户端端口', 'value': '59135'}, {'key': '客户端IP', 'value': '10.50.24.198'}, {'key': '标签', 'value': 'SQL注入'}, {'key': '动作', 'value': '警告'}, {'key': '国家', 'value': '局域网'}]
Testing ID: 102:
Testing LogText: <178>Dec 20 10:25:42 10-50-86-12 DBAppWAF: 发生时间/2024-12-20 10:25:37,威胁/中,事件/检测SQL注入,请求方法/GET,URL地址/10.50.109.90:31001/search,GET数据/user=admin&password=123456,服务器IP/10.50.109.90,主机名/10.50.109.90:31001,服务器端口/31001,客户端IP/10.50.24.198,客户端端口/59135,客户端环境/Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36,标签/SQL注入,动作/警告,HTTP/S响应码/403,攻击特征串/user=admin&password=123456,触发规则/10310001,访问唯一编号/7438514900033388674,国家/局域网,省/未知,市/未知,XFF_IP/
Testing LogField: [{'key': '', 'value': 'Dec 20 10:25:42'}, {'key': '', 'value': '10-50-86-12'}, {'key': '威胁', 'value': '中'}, {'key': '请求方法', 'value': 'GET'}, {'key': '主机名', 'value': '10.50.109.90:31001'}, {'key': '客户端端口', 'value': '59135'}, {'key': '客户端IP', 'value': '10.50.24.198'}, {'key': '标签', 'value': 'SQL注入'}, {'key': '动作', 'value': '警告'}, {'key': '国家', 'value': '局域网'}]
Generated LogField: [{'key': '', 'value': '10-50-86-12'}, {'key': '威胁', 'value': '中'}, {'key': '请求方法', 'value': 'GET'}, {'key': '主机名', 'value': '10.50.109.90:31001'}, {'key': '客户端端口', 'value': '59135'}, {'key': '客户端IP', 'value': '10.50.24.198'}, {'key': '标签', 'value': 'SQL注入'}, {'key': '动作', 'value': '警告'}, {'key': '国家', 'value': '局域网'}]
至少有一个匹配！full_coverage: 90.00%
2
gen_result = [{'key': '', 'value': '10-50-86-13'}, {'key': '事件', 'value': 'SQL注入攻击'}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': '80'}, {'key': '客户端IP', 'value': '10.50.86.36'}, {'key': '标签', 'value': 'SQL注入'}, {'key': '动作', 'value': '阻断'}, {'key': '访问唯一编号', 'value': '7428041192777978970'}, {'key': '国家', 'value': '局域网'}]

init data: [{'key': '', 'value': '10-50-86-13'}, {'key': '事件', 'value': 'SQL注入攻击'}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': '80'}, {'key': '客户端IP', 'value': '10.50.86.36'}, {'key': '标签', 'value': 'SQL注入'}, {'key': '动作', 'value': '阻断'}, {'key': '访问唯一编号', 'value': '7428041192777978970'}, {'key': '国家', 'value': '局域网'}]

valid data: [{"key": "", "value": "10-50-86-13"}, {"key": "事件", "value": "SQL注入攻击"}, {"key": "服务器IP", "value": "10.50.109.2"}, {"key": "服务器端口", "value": "80"}, {"key": "客户端IP", "value": "10.50.86.36"}, {"key": "标签", "value": "SQL注入"}, {"key": "动作", "value": "阻断"}, {"key": "访问唯一编号", "value": "7428041192777978970"}, {"key": "国家", "value": "局域网"}]

<class 'list'>
[{'key': '', 'value': '10-50-86-13'}, {'key': '事件', 'value': 'SQL注入攻击'}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': '80'}, {'key': '客户端IP', 'value': '10.50.86.36'}, {'key': '标签', 'value': 'SQL注入'}, {'key': '动作', 'value': '阻断'}, {'key': '访问唯一编号', 'value': '7428041192777978970'}, {'key': '国家', 'value': '局域网'}]
Testing ID: 103:
Testing LogText: <178>Nov 15 14:22:15 10-50-86-13 DBAppWAF: 发生时间/2024-11-15 14:22:03,威胁/中,事件/SQL注入攻击,请求方法/POST,URL地址/10.50.109.2/admin/login.php,POST数据/username=admin&password=123456,服务器IP/10.50.109.2,主机名/10.50.109.2,服务器端口/80,客户端IP/10.50.86.36,客户端端口/56789,客户端环境/Mozilla/5.0 [en] (X11, U; DBAPPSecurity 21.4.3),标签/SQL注入,动作/阻断,HTTP/S响应码/403,攻击特征串/admin/login.php?username=admin&password=123456,触发规则/11010102,访问唯一编号/7428041192777978970,国家/局域网,省/未知,市/未知,XFF_IP/
Testing LogField: [{'key': '', 'value': 'Nov 15 14:22:15'}, {'key': '', 'value': '10-50-86-13'}, {'key': '事件', 'value': 'SQL注入攻击'}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': '80'}, {'key': '客户端IP', 'value': '10.50.86.36'}, {'key': '标签', 'value': 'SQL注入'}, {'key': '动作', 'value': '阻断'}, {'key': '访问唯一编号', 'value': '7428041192777978970'}, {'key': '国家', 'value': '局域网'}]
Generated LogField: [{'key': '', 'value': '10-50-86-13'}, {'key': '事件', 'value': 'SQL注入攻击'}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': '80'}, {'key': '客户端IP', 'value': '10.50.86.36'}, {'key': '标签', 'value': 'SQL注入'}, {'key': '动作', 'value': '阻断'}, {'key': '访问唯一编号', 'value': '7428041192777978970'}, {'key': '国家', 'value': '局域网'}]
至少有一个匹配！full_coverage: 90.00%
3
gen_result = [{'key': '', 'value': '2024-12-20 10:21:08'}, {'key': 'AND password', 'value': "'123456'"}, {'key': 'hostname', 'value': '10-50-86-12'}, {'key': 'ip_port', 'value': '10-50-86-12'}, {'key': 'HTTP/S响应码', 'value': '403'}]

init data: [{'key': '', 'value': '2024-12-20 10:21:08'}, {'key': 'AND password', 'value': "'123456'"}, {'key': 'hostname', 'value': '10-50-86-12'}, {'key': 'ip_port', 'value': '10-50-86-12'}, {'key': 'HTTP/S响应码', 'value': '403'}]

valid data: [{"key": "", "value": "2024-12-20 10:21:08"}, {"key": "AND password", "value": "123456"}, {"key": "hostname", "value": "10-50-86-12"}, {"key": "ip_port", "value": "10-50-86-12"}, {"key": "HTTP/S响应码", "value": "403"}]

<class 'list'>
[{'key': '', 'value': '2024-12-20 10:21:08'}, {'key': 'AND password', 'value': '123456'}, {'key': 'hostname', 'value': '10-50-86-12'}, {'key': 'ip_port', 'value': '10-50-86-12'}, {'key': 'HTTP/S响应码', 'value': '403'}]
Testing ID: 104:
Testing LogText: <178>Dec 20 10:22:15 10-50-86-12 DBAppWAF: 发生时间/2024-12-20 10:21:08,威胁/中,事件/检测SQL注入(语义分析),请求方法/GET,URL地址/10.50.109.90:31001/vb5/?routestring=ajax/render/widget_sql,GET数据/query=SELECT+*+FROM+users+WHERE+username+%3D+%27admin%27+--+AND+password+%3D+%27123456%27,服务器IP/10.50.109.90,主机名/10.50.109.90:31001,服务器端口/31001,客户端IP/10.50.24.198,客户端端口/45377,客户端环境/Python-urllib/3.6,标签/通用防护,动作/警告,HTTP/S响应码/403,攻击特征串/SELECT * FROM users WHERE username = 'admin' -- AND password = '123456',触发规则/10130001,访问唯一编号/7438514904312627361,国家/局域网,省/未知,市/未知,XFF_IP/
Testing LogField: [{'key': '', 'value': 'Dec 20 10:22:15'}, {'key': '发生时间', 'value': '2024-12-20 10:21:08'}, {'key': '事件', 'value': '检测SQL注入(语义分析)'}, {'key': '请求方法', 'value': 'GET'}, {'key': 'GET数据', 'value': 'query=SELECT+*+FROM+users+WHERE+username+%3D+%27admin%27+--+AND+password+%3D+%27123456%27'}, {'key': '服务器IP', 'value': '10.50.109.90'}, {'key': '主机名', 'value': '10.50.109.90:31001'}, {'key': '标签', 'value': '通用防护'}, {'key': '动作', 'value': '警告'}, {'key': '访问唯一编号', 'value': '7438514904312627361'}]
Generated LogField: [{'key': '', 'value': '2024-12-20 10:21:08'}, {'key': 'AND password', 'value': '123456'}, {'key': 'hostname', 'value': '10-50-86-12'}, {'key': 'ip_port', 'value': '10-50-86-12'}, {'key': 'HTTP/S响应码', 'value': '403'}]
完全不匹配！
4
gen_result = [{'key': 'hostname', 'value': '10-50-86-12'}, {'key': 'alert', 'value': "'XSS'"}, {'key': '发生时间', 'value': '发生时间'}, {'key': '威胁', 'value': '威胁'}, {'key': '事件', 'value': '事件'}, {'key': '请求方法', 'value': '请求方法'}, {'key': 'URL地址', 'value': 'URL地址'}, {'key': 'POST数据', 'value': 'POST数据'}, {'key': '服务器IP', 'value': '服务器IP'}, {'key': '主机名', 'value': '主机名'}, {'key': '服务器端口', 'value': '服务器端口'}, {'key': '标签', 'value': '标签'}, {'key': '动作', 'value': '动作'}, {'key': 'HTTP/S响应码', 'value': 'HTTP/S响应码'}, {'key': '攻击特征串', 'value': '攻击特征串'}, {'key': '触发规则', 'value': '触发规则'}, {'key': '访问唯一编号', 'value': '访问唯一编号'}, {'key': '国家', 'value': '国家'}, {'key': '局域网', 'value': '局域网'}, {'key': '省', 'value': '省'}]

init data: [{'key': 'hostname', 'value': '10-50-86-12'}, {'key': 'alert', 'value': "'XSS'"}, {'key': '发生时间', 'value': '发生时间'}, {'key': '威胁', 'value': '威胁'}, {'key': '事件', 'value': '事件'}, {'key': '请求方法', 'value': '请求方法'}, {'key': 'URL地址', 'value': 'URL地址'}, {'key': 'POST数据', 'value': 'POST数据'}, {'key': '服务器IP', 'value': '服务器IP'}, {'key': '主机名', 'value': '主机名'}, {'key': '服务器端口', 'value': '服务器端口'}, {'key': '标签', 'value': '标签'}, {'key': '动作', 'value': '动作'}, {'key': 'HTTP/S响应码', 'value': 'HTTP/S响应码'}, {'key': '攻击特征串', 'value': '攻击特征串'}, {'key': '触发规则', 'value': '触发规则'}, {'key': '访问唯一编号', 'value': '访问唯一编号'}, {'key': '国家', 'value': '国家'}, {'key': '局域网', 'value': '局域网'}, {'key': '省', 'value': '省'}]

valid data: [{"key": "hostname", "value": "10-50-86-12"}, {"key": "alert", "value": "XSS"}, {"key": "发生时间", "value": "发生时间"}, {"key": "威胁", "value": "威胁"}, {"key": "事件", "value": "事件"}, {"key": "请求方法", "value": "请求方法"}, {"key": "URL地址", "value": "URL地址"}, {"key": "POST数据", "value": "POST数据"}, {"key": "服务器IP", "value": "服务器IP"}, {"key": "主机名", "value": "主机名"}, {"key": "服务器端口", "value": "服务器端口"}, {"key": "标签", "value": "标签"}, {"key": "动作", "value": "动作"}, {"key": "HTTP/S响应码", "value": "HTTP/S响应码"}, {"key": "攻击特征串", "value": "攻击特征串"}, {"key": "触发规则", "value": "触发规则"}, {"key": "访问唯一编号", "value": "访问唯一编号"}, {"key": "国家", "value": "国家"}, {"key": "局域网", "value": "局域网"}, {"key": "省", "value": "省"}]

<class 'list'>
[{'key': 'hostname', 'value': '10-50-86-12'}, {'key': 'alert', 'value': 'XSS'}, {'key': '发生时间', 'value': '发生时间'}, {'key': '威胁', 'value': '威胁'}, {'key': '事件', 'value': '事件'}, {'key': '请求方法', 'value': '请求方法'}, {'key': 'URL地址', 'value': 'URL地址'}, {'key': 'POST数据', 'value': 'POST数据'}, {'key': '服务器IP', 'value': '服务器IP'}, {'key': '主机名', 'value': '主机名'}, {'key': '服务器端口', 'value': '服务器端口'}, {'key': '标签', 'value': '标签'}, {'key': '动作', 'value': '动作'}, {'key': 'HTTP/S响应码', 'value': 'HTTP/S响应码'}, {'key': '攻击特征串', 'value': '攻击特征串'}, {'key': '触发规则', 'value': '触发规则'}, {'key': '访问唯一编号', 'value': '访问唯一编号'}, {'key': '国家', 'value': '国家'}, {'key': '局域网', 'value': '局域网'}, {'key': '省', 'value': '省'}]
Testing ID: 105:
Testing LogText: <178>Aug 15 11:25:12 10-50-86-12 DBAppWAF: 发生时间/2024-08-15 11:25:10,威胁/低,事件/阻止携带恶意脚本的请求,请求方法/GET,URL地址//index.php,POST数据/,服务器IP/10.50.109.79,主机名/,服务器端口/80,客户端IP/10.20.170.23,客户端端口/45678,客户端环境/,标签/恶意脚本,动作/阻断,HTTP/S响应码/403,攻击特征串/<script>alert('XSS')</script>,触发规则/11010103,访问唯一编号/7403201528594620509,国家/局域网,省/未知,市/未知,XFF_IP/
Testing LogField: [{'key': '', 'value': 'Aug 15 11:25:12'}, {'key': '发生时间', 'value': '2024-08-15 11:25:10'}, {'key': '事件', 'value': '阻止携带恶意脚本的请求'}, {'key': '客户端IP', 'value': '10.20.170.23'}, {'key': '客户端端口', 'value': '45678'}, {'key': '触发规则', 'value': '11010103'}, {'key': '访问唯一编号', 'value': '7403201528594620509'}, {'key': '国家', 'value': '局域网'}, {'key': '省', 'value': '未知'}]
Generated LogField: [{'key': 'hostname', 'value': '10-50-86-12'}, {'key': 'alert', 'value': 'XSS'}, {'key': '发生时间', 'value': '发生时间'}, {'key': '威胁', 'value': '威胁'}, {'key': '事件', 'value': '事件'}, {'key': '请求方法', 'value': '请求方法'}, {'key': 'URL地址', 'value': 'URL地址'}, {'key': 'POST数据', 'value': 'POST数据'}, {'key': '服务器IP', 'value': '服务器IP'}, {'key': '主机名', 'value': '主机名'}, {'key': '服务器端口', 'value': '服务器端口'}, {'key': '标签', 'value': '标签'}, {'key': '动作', 'value': '动作'}, {'key': 'HTTP/S响应码', 'value': 'HTTP/S响应码'}, {'key': '攻击特征串', 'value': '攻击特征串'}, {'key': '触发规则', 'value': '触发规则'}, {'key': '访问唯一编号', 'value': '访问唯一编号'}, {'key': '国家', 'value': '国家'}, {'key': '局域网', 'value': '局域网'}, {'key': '省', 'value': '省'}]
完全不匹配！
5
gen_result = [{'key': '', 'value': '10-50-86-13'}, {'key': '服务器IP', 'value': '10.50.109.3'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.109.3'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.109.3'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.86.36'}, {'key': '服务器端口', 'value': None}, {'key': 'HTTP/S响应码', 'value': '403'}, {'key': '攻击特征串', 'value': 'admin&password=123456'}, {'key': '触发规则', 'value': '10110001'}, {'key': '访问唯一编号', 'value': '7428040999502353439'}, {'key': '事件', 'value': '检测SQL注入'}, {'key': '请求方法', 'value': 'POST'}, {'key': 'URL地址', 'value': '10.50.109.3/login.php?action=login&username=admin&password=123456'}, {'key': '标签', 'value': 'SQL注入'}, {'key': '动作', 'value': '阻断'}]

init data: [{'key': '', 'value': '10-50-86-13'}, {'key': '服务器IP', 'value': '10.50.109.3'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.109.3'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.109.3'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.86.36'}, {'key': '服务器端口', 'value': None}, {'key': 'HTTP/S响应码', 'value': '403'}, {'key': '攻击特征串', 'value': 'admin&password=123456'}, {'key': '触发规则', 'value': '10110001'}, {'key': '访问唯一编号', 'value': '7428040999502353439'}, {'key': '事件', 'value': '检测SQL注入'}, {'key': '请求方法', 'value': 'POST'}, {'key': 'URL地址', 'value': '10.50.109.3/login.php?action=login&username=admin&password=123456'}, {'key': '标签', 'value': 'SQL注入'}, {'key': '动作', 'value': '阻断'}]

valid data: [{"key": "", "value": "10-50-86-13"}, {"key": "服务器IP", "value": "10.50.109.3"}, {"key": "服务器端口", "value": None}, {"key": "服务器IP", "value": "10.50.109.3"}, {"key": "服务器端口", "value": None}, {"key": "服务器IP", "value": "10.50.109.3"}, {"key": "服务器端口", "value": None}, {"key": "服务器IP", "value": "10.50.86.36"}, {"key": "服务器端口", "value": None}, {"key": "HTTP/S响应码", "value": "403"}, {"key": "攻击特征串", "value": "admin&password=123456"}, {"key": "触发规则", "value": "10110001"}, {"key": "访问唯一编号", "value": "7428040999502353439"}, {"key": "事件", "value": "检测SQL注入"}, {"key": "请求方法", "value": "POST"}, {"key": "URL地址", "value": "10.50.109.3/login.php?action=login&username=admin&password=123456"}, {"key": "标签", "value": "SQL注入"}, {"key": "动作", "value": "阻断"}]

<class 'list'>
[{'key': '', 'value': '10-50-86-13'}, {'key': '服务器IP', 'value': '10.50.109.3'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.109.3'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.109.3'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.86.36'}, {'key': '服务器端口', 'value': None}, {'key': 'HTTP/S响应码', 'value': '403'}, {'key': '攻击特征串', 'value': 'admin&password=123456'}, {'key': '触发规则', 'value': '10110001'}, {'key': '访问唯一编号', 'value': '7428040999502353439'}, {'key': '事件', 'value': '检测SQL注入'}, {'key': '请求方法', 'value': 'POST'}, {'key': 'URL地址', 'value': '10.50.109.3/login.php?action=login&username=admin&password=123456'}, {'key': '标签', 'value': 'SQL注入'}, {'key': '动作', 'value': '阻断'}]
Testing ID: 106:
Testing LogText: <178>Oct 22 10:30:45 10-50-86-13 DBAppWAF: 发生时间/2024-10-22 10:30:38,威胁/中,事件/检测SQL注入,请求方法/POST,URL地址/10.50.109.3/login.php?action=login&username=admin&password=123456,POST数据/username=admin&password=123456,服务器IP/10.50.109.3,主机名/10.50.109.3,服务器端口/80,客户端IP/10.50.86.36,客户端端口/59757,客户端环境/Mozilla/5.0 [en] (X11, U; DBAPPSecurity 21.4.3),标签/SQL注入,动作/阻断,HTTP/S响应码/403,攻击特征串/admin&password=123456,触发规则/10110001,访问唯一编号/7428040999502353439,国家/局域网,省/未知,市/未知,XFF_IP/
Testing LogField: [{'key': '', 'value': 'Oct 22 10:30:45'}, {'key': '', 'value': '10-50-86-13'}, {'key': '事件', 'value': '检测SQL注入'}, {'key': '请求方法', 'value': 'POST'}, {'key': 'URL地址', 'value': '10.50.109.3/login.php?action=login&username=admin&password=123456'}, {'key': '客户端环境', 'value': 'Mozilla/5.0 [en] (X11, U; DBAPPSecurity 21.4.3)'}, {'key': '标签', 'value': 'SQL注入'}, {'key': '动作', 'value': '阻断'}, {'key': '触发规则', 'value': '10110001'}, {'key': '访问唯一编号', 'value': '7428040999502353439'}]
Generated LogField: [{'key': '', 'value': '10-50-86-13'}, {'key': '服务器IP', 'value': '10.50.109.3'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.109.3'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.109.3'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.86.36'}, {'key': '服务器端口', 'value': None}, {'key': 'HTTP/S响应码', 'value': '403'}, {'key': '攻击特征串', 'value': 'admin&password=123456'}, {'key': '触发规则', 'value': '10110001'}, {'key': '访问唯一编号', 'value': '7428040999502353439'}, {'key': '事件', 'value': '检测SQL注入'}, {'key': '请求方法', 'value': 'POST'}, {'key': 'URL地址', 'value': '10.50.109.3/login.php?action=login&username=admin&password=123456'}, {'key': '标签', 'value': 'SQL注入'}, {'key': '动作', 'value': '阻断'}]
至少有一个匹配！full_coverage: 80.00%
6
gen_result = [{'key': '', 'value': '10-50-86-15'}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.86.45'}, {'key': '服务器端口', 'value': None}, {'key': 'HTTP/S响应码', 'value': '403'}, {'key': '发生时间', 'value': '2024-11-15 14:23:01'}, {'key': '威胁', 'value': '高'}, {'key': '事件', 'value': '检测SQL注入攻击'}, {'key': '请求方法', 'value': 'POST'}, {'key': 'URL地址', 'value': '10.50.109.2/api/login.php'}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': '80'}]

init data: [{'key': '', 'value': '10-50-86-15'}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.86.45'}, {'key': '服务器端口', 'value': None}, {'key': 'HTTP/S响应码', 'value': '403'}, {'key': '发生时间', 'value': '2024-11-15 14:23:01'}, {'key': '威胁', 'value': '高'}, {'key': '事件', 'value': '检测SQL注入攻击'}, {'key': '请求方法', 'value': 'POST'}, {'key': 'URL地址', 'value': '10.50.109.2/api/login.php'}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': '80'}]

valid data: [{"key": "", "value": "10-50-86-15"}, {"key": "服务器IP", "value": "10.50.109.2"}, {"key": "服务器端口", "value": None}, {"key": "服务器IP", "value": "10.50.109.2"}, {"key": "服务器端口", "value": None}, {"key": "服务器IP", "value": "10.50.109.2"}, {"key": "服务器端口", "value": None}, {"key": "服务器IP", "value": "10.50.86.45"}, {"key": "服务器端口", "value": None}, {"key": "HTTP/S响应码", "value": "403"}, {"key": "发生时间", "value": "2024-11-15 14:23:01"}, {"key": "威胁", "value": "高"}, {"key": "事件", "value": "检测SQL注入攻击"}, {"key": "请求方法", "value": "POST"}, {"key": "URL地址", "value": "10.50.109.2/api/login.php"}, {"key": "服务器IP", "value": "10.50.109.2"}, {"key": "服务器端口", "value": "80"}]

<class 'list'>
[{'key': '', 'value': '10-50-86-15'}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.86.45'}, {'key': '服务器端口', 'value': None}, {'key': 'HTTP/S响应码', 'value': '403'}, {'key': '发生时间', 'value': '2024-11-15 14:23:01'}, {'key': '威胁', 'value': '高'}, {'key': '事件', 'value': '检测SQL注入攻击'}, {'key': '请求方法', 'value': 'POST'}, {'key': 'URL地址', 'value': '10.50.109.2/api/login.php'}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': '80'}]
Testing ID: 107:
Testing LogText: <178>Nov 15 14:23:12 10-50-86-15 DBAppWAF: 发生时间/2024-11-15 14:23:01,威胁/高,事件/检测SQL注入攻击,请求方法/POST,URL地址/10.50.109.2/api/login.php,POST数据/user=admin' OR '1'='1,服务器IP/10.50.109.2,主机名/10.50.109.2,服务器端口/80,客户端IP/10.50.86.45,客户端端口/51234,客户端环境/Mozilla/5.0 [en] (X11, U; DBAPPSecurity 21.4.3),标签/通用防护,动作/阻断,HTTP/S响应码/403,攻击特征串/admin' OR '1'='1,触发规则/10350001,访问唯一编号/7428040947963794435,国家/局域网,省/未知,市/未知,XFF_IP/
Testing LogField: [{'key': '', 'value': 'Nov 15 14:23:12'}, {'key': '', 'value': '10-50-86-15'}, {'key': '发生时间', 'value': '2024-11-15 14:23:01'}, {'key': '威胁', 'value': '高'}, {'key': '事件', 'value': '检测SQL注入攻击'}, {'key': '请求方法', 'value': 'POST'}, {'key': 'URL地址', 'value': '10.50.109.2/api/login.php'}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': '80'}]
Generated LogField: [{'key': '', 'value': '10-50-86-15'}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': None}, {'key': '服务器IP', 'value': '10.50.86.45'}, {'key': '服务器端口', 'value': None}, {'key': 'HTTP/S响应码', 'value': '403'}, {'key': '发生时间', 'value': '2024-11-15 14:23:01'}, {'key': '威胁', 'value': '高'}, {'key': '事件', 'value': '检测SQL注入攻击'}, {'key': '请求方法', 'value': 'POST'}, {'key': 'URL地址', 'value': '10.50.109.2/api/login.php'}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': '80'}]
至少有一个匹配！full_coverage: 89.00%
7
gen_result = [{'key': '', 'value': '10-50-86-15'}, {'key': 'function', 'value': "alert('XSS')"}, {'key': 'Web端口', 'value': '10-50-86-15'}, {'key': '<178>Nov 15 14:30:45 10-50-86-15 DBAppWAF: 发生时间', 'value': '2024-11-15 14:30:30'}, {'key': '威胁', 'value': '中'}, {'key': '事件', 'value': '检测XSS攻击'}, {'key': '请求方法', 'value': 'POST'}, {'key': 'URL地址', 'value': '10.50.109.2/ez/login.php?username=admin&password=123456'}, {'key': 'POST数据', 'value': 'username=admin&password=123456'}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '主机名', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': '80'}, {'key': '客户端IP', 'value': '10.50.86.45'}, {'key': '客户端端口', 'value': '56190'}, {'key': '客户端环境', 'value': 'Mozilla/5.0 [en] (X11'}, {'key': '标签', 'value': '通用防护'}, {'key': '动作', 'value': '告警'}, {'key': 'HTTP', 'value': 'S响应码/403'}, {'key': '攻击特征串', 'value': "<script>alert('XSS')</script>"}, {'key': '触发规则', 'value': '10120001'}, {'key': '访问唯一编号', 'value': '7428040333788713715'}, {'key': '国家', 'value': '局域网'}, {'key': '省', 'value': '未知'}, {'key': '市', 'value': '未知'}, {'key': 'HTTP/S响应码', 'value': '403'}, {'key': '关键词', 'value': '发生时间'}, {'key': '关键词', 'value': '威胁'}, {'key': '关键词', 'value': '事件'}, {'key': '关键词', 'value': '请求方法'}, {'key': '关键词', 'value': 'URL地址'}, {'key': '关键词', 'value': 'POST数据'}, {'key': '关键词', 'value': '服务器IP'}, {'key': '关键词', 'value': '主机名'}, {'key': '关键词', 'value': '服务器端口'}, {'key': '关键词', 'value': '标签'}, {'key': '关键词', 'value': '动作'}, {'key': '关键词', 'value': 'HTTP/S响应码'}, {'key': '关键词', 'value': '攻击特征串'}, {'key': '关键词', 'value': '触发规则'}, {'key': '关键词', 'value': '访问唯一编号'}, {'key': '关键词', 'value': '国家'}, {'key': '关键词', 'value': '局域网'}, {'key': '关键词', 'value': '省'}]

init data: [{'key': '', 'value': '10-50-86-15'}, {'key': 'function', 'value': "alert('XSS')"}, {'key': 'Web端口', 'value': '10-50-86-15'}, {'key': '<178>Nov 15 14:30:45 10-50-86-15 DBAppWAF: 发生时间', 'value': '2024-11-15 14:30:30'}, {'key': '威胁', 'value': '中'}, {'key': '事件', 'value': '检测XSS攻击'}, {'key': '请求方法', 'value': 'POST'}, {'key': 'URL地址', 'value': '10.50.109.2/ez/login.php?username=admin&password=123456'}, {'key': 'POST数据', 'value': 'username=admin&password=123456'}, {'key': '服务器IP', 'value': '10.50.109.2'}, {'key': '主机名', 'value': '10.50.109.2'}, {'key': '服务器端口', 'value': '80'}, {'key': '客户端IP', 'value': '10.50.86.45'}, {'key': '客户端端口', 'value': '56190'}, {'key': '客户端环境', 'value': 'Mozilla/5.0 [en] (X11'}, {'key': '标签', 'value': '通用防护'}, {'key': '动作', 'value': '告警'}, {'key': 'HTTP', 'value': 'S响应码/403'}, {'key': '攻击特征串', 'value': "<script>alert('XSS')</script>"}, {'key': '触发规则', 'value': '10120001'}, {'key': '访问唯一编号', 'value': '7428040333788713715'}, {'key': '国家', 'value': '局域网'}, {'key': '省', 'value': '未知'}, {'key': '市', 'value': '未知'}, {'key': 'HTTP/S响应码', 'value': '403'}, {'key': '关键词', 'value': '发生时间'}, {'key': '关键词', 'value': '威胁'}, {'key': '关键词', 'value': '事件'}, {'key': '关键词', 'value': '请求方法'}, {'key': '关键词', 'value': 'URL地址'}, {'key': '关键词', 'value': 'POST数据'}, {'key': '关键词', 'value': '服务器IP'}, {'key': '关键词', 'value': '主机名'}, {'key': '关键词', 'value': '服务器端口'}, {'key': '关键词', 'value': '标签'}, {'key': '关键词', 'value': '动作'}, {'key': '关键词', 'value': 'HTTP/S响应码'}, {'key': '关键词', 'value': '攻击特征串'}, {'key': '关键词', 'value': '触发规则'}, {'key': '关键词', 'value': '访问唯一编号'}, {'key': '关键词', 'value': '国家'}, {'key': '关键词', 'value': '局域网'}, {'key': '关键词', 'value': '省'}]

valid data: [{"key": "", "value": "10-50-86-15"}, {"key": "function", "value": "alert("XSS")"}, {"key": "Web端口", "value": "10-50-86-15"}, {"key": "<178>Nov 15 14:30:45 10-50-86-15 DBAppWAF: 发生时间", "value": "2024-11-15 14:30:30"}, {"key": "威胁", "value": "中"}, {"key": "事件", "value": "检测XSS攻击"}, {"key": "请求方法", "value": "POST"}, {"key": "URL地址", "value": "10.50.109.2/ez/login.php?username=admin&password=123456"}, {"key": "POST数据", "value": "username=admin&password=123456"}, {"key": "服务器IP", "value": "10.50.109.2"}, {"key": "主机名", "value": "10.50.109.2"}, {"key": "服务器端口", "value": "80"}, {"key": "客户端IP", "value": "10.50.86.45"}, {"key": "客户端端口", "value": "56190"}, {"key": "客户端环境", "value": "Mozilla/5.0 [en] (X11"}, {"key": "标签", "value": "通用防护"}, {"key": "动作", "value": "告警"}, {"key": "HTTP", "value": "S响应码/403"}, {"key": "攻击特征串", "value": "<script>alert("XSS")</script>"}, {"key": "触发规则", "value": "10120001"}, {"key": "访问唯一编号", "value": "7428040333788713715"}, {"key": "国家", "value": "局域网"}, {"key": "省", "value": "未知"}, {"key": "市", "value": "未知"}, {"key": "HTTP/S响应码", "value": "403"}, {"key": "关键词", "value": "发生时间"}, {"key": "关键词", "value": "威胁"}, {"key": "关键词", "value": "事件"}, {"key": "关键词", "value": "请求方法"}, {"key": "关键词", "value": "URL地址"}, {"key": "关键词", "value": "POST数据"}, {"key": "关键词", "value": "服务器IP"}, {"key": "关键词", "value": "主机名"}, {"key": "关键词", "value": "服务器端口"}, {"key": "关键词", "value": "标签"}, {"key": "关键词", "value": "动作"}, {"key": "关键词", "value": "HTTP/S响应码"}, {"key": "关键词", "value": "攻击特征串"}, {"key": "关键词", "value": "触发规则"}, {"key": "关键词", "value": "访问唯一编号"}, {"key": "关键词", "value": "国家"}, {"key": "关键词", "value": "局域网"}, {"key": "关键词", "value": "省"}]

